# Phase 5 快速测试指南

## 🚀 快速开始

### 方法 1: 自动化测试（推荐）

1. **启动应用**
   ```bash
   cd kitchenflow-app
   npm start
   ```

2. **访问测试屏幕**
   - 在应用中导航到：`dev/test-phase5`
   - 或使用深度链接：`kitchenflow://dev/test-phase5`

3. **运行测试**
   - 点击 "Run Phase 5 Tests" 按钮
   - 查看测试结果和摘要

### 方法 2: 手动测试

#### 步骤 1: 准备测试数据

1. **创建库存快照**
   - 进入扫描功能
   - 扫描一些食材（例如：番茄、洋葱）
   - 确保库存中有部分食材，但不是全部

2. **创建 Craving**
   - 进入 Cravings 页面
   - 添加一个菜谱链接或输入菜名
   - 等待 AI 分析完成（确保有 `required_ingredients`）

#### 步骤 2: 测试添加功能

1. **触发添加**
   - 在 Cravings 页面找到有食材的 Craving
   - 点击 CravingCard 右上角的 🛒 按钮

2. **验证模态框**
   - ✅ 模态框应该显示
   - ✅ 显示 Craving 名称
   - ✅ 显示缺失食材列表
   - ✅ 显示已拥有食材列表（如果有）
   - ✅ 每个食材有商店选择器

3. **测试商店选择**
   - 点击某个食材的商店选择器
   - 选择不同的商店
   - 验证选择已更新

4. **添加食材**
   - 点击 "Add X Items" 按钮
   - 应该显示成功消息
   - 自动导航到购物清单页面
   - 验证食材已添加并正确分组

#### 步骤 3: 验证数据

1. **检查购物清单**
   - 食材按商店正确分组
   - 显示正确的商店图标
   - 可以正常编辑和删除

2. **检查数据库**（可选）
   - 在 Supabase Dashboard 查看 `shopping_items` 表
   - 验证 `store_id`、`source`、`source_craving_id` 字段

## ✅ 测试检查清单

### 功能测试
- [ ] 食材匹配功能正常（完全匹配、数量不足、完全缺失）
- [ ] 模糊匹配工作（单复数、变体）
- [ ] 商店推荐功能正常
- [ ] 模态框显示和交互正常
- [ ] 添加到购物清单功能正常
- [ ] 数据正确保存到数据库

### UI/UX 测试
- [ ] 🛒 按钮正确显示（只在有食材时）
- [ ] 模态框样式正确（glassmorphism）
- [ ] 商店选择器交互流畅
- [ ] 滚动功能正常（长列表）

### 边界情况
- [ ] 没有食材的 Craving 显示正确提示
- [ ] 所有食材都已拥有时显示正确提示
- [ ] 库存过期警告正确显示（>3天）
- [ ] 没有库存数据时正常工作

## 🐛 常见问题

### 问题：点击 🛒 按钮没有反应
**解决**：
- 检查 Craving 是否有 `required_ingredients`
- 检查控制台是否有错误
- 确保设备 ID 已加载

### 问题：食材匹配不准确
**解决**：
- 检查食材名称是否相似
- 考虑改进匹配算法（在 `ingredientMatcher.ts` 中）

### 问题：模态框显示异常
**解决**：
- 检查 React Native 版本
- 清除缓存：`npm start -- --reset-cache`

## 📊 测试结果

如果所有测试通过，您应该看到：
- ✅ 6 个自动化测试全部通过
- ✅ 手动测试流程顺利完成
- ✅ 数据正确保存和显示

## 📝 下一步

测试通过后：
1. 继续 Phase 6: 在线购物 WebView 功能
2. 优化匹配算法
3. 改进商店推荐逻辑
4. 添加更多测试用例

---

**详细测试指南**: 查看 `docs/PHASE5_TESTING_GUIDE.md`
