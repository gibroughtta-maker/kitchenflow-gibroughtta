---
description: 完成任务、实现主要功能后，或在合并前使用 - 验证工作符合要求
---

# 请求代码审查

## 第一性原理

**为什么要主动审查？** 问题发现得越早，修复成本越低。自己写的代码有盲点，需要第三方视角。

**核心公理：**
1. 预防 > 修复 - 审查是预防性质量保证
2. 客观视角发现主观盲点
3. 小步审查减少大问题

## 何时请求审查

**强制：**
- 完成每个任务后
- 完成主要功能后
- 合并到主分支前

**可选但有价值：**
- 当你卡住时（换个视角）
- 重构前（建立基线）
- 修复复杂 bug 后

## 如何请求

### 1. 获取 git SHA
```bash
BASE_SHA=$(git rev-parse HEAD~1)  # 或 origin/main
HEAD_SHA=$(git rev-parse HEAD)
```

### 2. 提供清晰信息
- **实现了什么** - 你刚构建的东西
- **需求是什么** - 应该做什么
- **变更范围** - 起始和结束提交
- **简要描述** - 一句话总结

### 3. 根据反馈行动
- 立即修复 Critical 问题
- 继续前修复 Important 问题
- 记录 Minor 问题稍后处理
- 如果审查者错了，用理由推回

## 示例

```
[刚完成任务 2：添加验证函数]

我：让我在继续前请求代码审查。

BASE_SHA=a7981ec
HEAD_SHA=3df7661

[派发代码审查]
  实现内容：会话索引的验证和修复函数
  需求：docs/plans/deployment-plan.md 中的任务 2
  描述：添加了 verifyIndex() 和 repairIndex()，支持 4 种问题类型

[审查者返回]：
  优点：架构清晰，有真实测试
  问题：
    重要：缺少进度指示器
    次要：魔法数字 (100) 用于报告间隔
  评估：可以继续

我：[修复进度指示器]
[继续任务 3]
```

## 危险信号

**绝不要：**
- 因为"很简单"就跳过审查
- 忽略 Critical 问题
- 带着未修复的 Important 问题继续
- 与有效的技术反馈争论
